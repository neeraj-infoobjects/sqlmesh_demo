2024-11-21 21:53:04,478 - MainThread - sqlmesh.core.dialect - WARNING - 'CREATE ROLE IF NOT EXISTS sqlmesh' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:53:04,480 - MainThread - sqlmesh.core.dialect - WARNING - 'GRANT USAGE ON FUTURE SCHEMAS IN DATABASE demo_db TO ROLE sqlmesh' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:53:04,482 - MainThread - sqlmesh.core.dialect - WARNING - 'GRANT CREATE TABLE ON FUTURE SCHEMAS IN DATABASE demo_db TO ROLE sqlmesh' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:53:04,484 - MainThread - sqlmesh.core.dialect - WARNING - 'GRANT CREATE VIEW ON FUTURE SCHEMAS IN DATABASE demo_db TO ROLE sqlmesh' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:53:04,486 - MainThread - sqlmesh.core.dialect - WARNING - 'GRANT SELECT, INSERT, TRUNCATE, UPDATE, DELETE ON FUTURE TABLES IN DATABASE demo_db TO ROLE sqlmesh' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:53:04,487 - MainThread - sqlmesh.core.dialect - WARNING - 'GRANT REFERENCES, SELECT ON FUTURE VIEWS IN DATABASE demo_db TO ROLE sqlmesh' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:53:04,489 - MainThread - sqlmesh.core.dialect - WARNING - 'GRANT ROLE sqlmesh TO USER neeraj' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:53:06,018 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:325)
2024-11-21 21:53:06,078 - MainThread - sqlmesh.core.config.scheduler - WARNING - The snowflake engine is not recommended for storing SQLMesh state in production deployments. Please see https://sqlmesh.readthedocs.io/en/stable/guides/configuration/#state-connection for a list of recommended engines and more information. (scheduler.py:94)
2024-11-21 21:53:06,085 - MainThread - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.2, Platform: Windows-10-10.0.19045-SP0 (connection.py:414)
2024-11-21 21:53:06,086 - MainThread - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain (connection.py:1197)
2024-11-21 21:53:06,086 - MainThread - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity. (connection.py:1278)
2024-11-21 21:53:07,981 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 3 (cursor.py:1166)
2024-11-21 21:53:08,126 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:08,320 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:08,520 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:08,718 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 3 (cursor.py:1166)
2024-11-21 21:53:08,980 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:09,126 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:09,304 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:09,487 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:09,679 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:09,879 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 9 (cursor.py:1166)
2024-11-21 21:53:10,033 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:10,182 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 9 (cursor.py:1166)
2024-11-21 21:53:10,322 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:10,569 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 0 (cursor.py:1166)
2024-11-21 21:53:11,533 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:11,679 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:11,825 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:12,081 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:12,224 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:12,482 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:12,626 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:15,460 - ThreadPoolExecutor-9_0 - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema NB_DEMOS.sqlmesh__SQLMESH_EXAMPLE (evaluator.py:282)
2024-11-21 21:53:15,461 - ThreadPoolExecutor-9_0 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.2, Platform: Windows-10-10.0.19045-SP0 (connection.py:414)
2024-11-21 21:53:15,461 - ThreadPoolExecutor-9_0 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain (connection.py:1197)
2024-11-21 21:53:15,461 - ThreadPoolExecutor-9_0 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity. (connection.py:1278)
2024-11-21 21:53:16,911 - ThreadPoolExecutor-9_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_DATABASE() (base.py:2062)
2024-11-21 21:53:17,080 - ThreadPoolExecutor-9_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:17,280 - ThreadPoolExecutor-9_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:17,281 - ThreadPoolExecutor-9_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_DATABASE() (base.py:2062)
2024-11-21 21:53:17,482 - ThreadPoolExecutor-9_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:17,624 - ThreadPoolExecutor-9_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:17,642 - ThreadPoolExecutor-9_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT DISTINCT "TABLE_CATALOG" AS "catalog", "TABLE_NAME" AS "name", "TABLE_SCHEMA" AS "schema_name", CASE WHEN "TABLE_TYPE" = 'BASE TABLE' AND "IS_DYNAMIC" = 'YES' THEN 'MANAGED_TABLE' WHEN "TABLE_TYPE" = 'BASE TABLE' THEN 'TABLE' WHEN "TABLE_TYPE" = 'TEMPORARY TABLE' THEN 'TABLE' WHEN "TABLE_TYPE" = 'LOCAL TEMPORARY' THEN 'TABLE' WHEN "TABLE_TYPE" = 'EXTERNAL TABLE' THEN 'TABLE' WHEN "TABLE_TYPE" = 'EVENT TABLE' THEN 'TABLE' WHEN "TABLE_TYPE" = 'VIEW' THEN 'VIEW' WHEN "TABLE_TYPE" = 'MATERIALIZED VIEW' THEN 'MATERIALIZED_VIEW' ELSE "TABLE_TYPE" END AS "type", "CLUSTERING_KEY" AS "clustering_key" FROM "NB_DEMOS"."INFORMATION_SCHEMA"."TABLES" WHERE "TABLE_SCHEMA" = 'sqlmesh__SQLMESH_EXAMPLE' AND "TABLE_NAME" IN ('SQLMESH_EXAMPLE__SEED_MODEL__371811167', 'SQLMESH_EXAMPLE__GRANT_MODEL__171822437') (base.py:2062)
2024-11-21 21:53:18,490 - ThreadPoolExecutor-9_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:18,679 - ThreadPoolExecutor-9_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:18,696 - MainThread - snowflake.connector.connection - INFO - closed (connection.py:789)
2024-11-21 21:53:18,880 - MainThread - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session (connection.py:795)
2024-11-21 21:53:19,030 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'NB_DEMOS.sqlmesh__SQLMESH_EXAMPLE' (evaluator.py:906)
2024-11-21 21:53:19,032 - MainThread - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.2, Platform: Windows-10-10.0.19045-SP0 (connection.py:414)
2024-11-21 21:53:19,034 - MainThread - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain (connection.py:1197)
2024-11-21 21:53:19,034 - MainThread - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity. (connection.py:1278)
2024-11-21 21:53:20,492 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "NB_DEMOS"."sqlmesh__SQLMESH_EXAMPLE" (base.py:2062)
2024-11-21 21:53:20,682 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:20,883 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:20,885 - ThreadPoolExecutor-13_0 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.2, Platform: Windows-10-10.0.19045-SP0 (connection.py:414)
2024-11-21 21:53:20,886 - ThreadPoolExecutor-13_0 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain (connection.py:1197)
2024-11-21 21:53:20,887 - ThreadPoolExecutor-13_0 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity. (connection.py:1278)
2024-11-21 21:53:22,464 - ThreadPoolExecutor-13_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: USE ROLE "ACCOUNTADMIN" (base.py:2062)
2024-11-21 21:53:22,622 - ThreadPoolExecutor-13_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:22,623 - ThreadPoolExecutor-13_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE ROLE IF NOT EXISTS sqlmesh (base.py:2062)
2024-11-21 21:53:22,880 - ThreadPoolExecutor-13_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:22,882 - ThreadPoolExecutor-13_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE DATABASE IF NOT EXISTS "DEMO_DB" (base.py:2062)
2024-11-21 21:53:23,027 - ThreadPoolExecutor-13_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:23,029 - ThreadPoolExecutor-13_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: GRANT USAGE ON WAREHOUSE "COMPUTE_WH" TO ROLE "SQLMESH" (base.py:2062)
2024-11-21 21:53:23,212 - ThreadPoolExecutor-13_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:23,215 - ThreadPoolExecutor-13_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: GRANT USAGE ON DATABASE "DEMO_DB" TO ROLE "SQLMESH" (base.py:2062)
2024-11-21 21:53:23,483 - ThreadPoolExecutor-13_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:23,486 - ThreadPoolExecutor-13_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: GRANT CREATE SCHEMA ON DATABASE "DEMO_DB" TO ROLE "SQLMESH" (base.py:2062)
2024-11-21 21:53:23,681 - ThreadPoolExecutor-13_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:23,683 - ThreadPoolExecutor-13_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: GRANT USAGE ON FUTURE SCHEMAS IN DATABASE demo_db TO ROLE sqlmesh (base.py:2062)
2024-11-21 21:53:23,883 - ThreadPoolExecutor-13_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:23,885 - ThreadPoolExecutor-13_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: GRANT CREATE TABLE ON FUTURE SCHEMAS IN DATABASE demo_db TO ROLE sqlmesh (base.py:2062)
2024-11-21 21:53:24,080 - ThreadPoolExecutor-13_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:24,081 - ThreadPoolExecutor-13_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: GRANT CREATE VIEW ON FUTURE SCHEMAS IN DATABASE demo_db TO ROLE sqlmesh (base.py:2062)
2024-11-21 21:53:24,282 - ThreadPoolExecutor-13_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:24,284 - ThreadPoolExecutor-13_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: GRANT SELECT, INSERT, TRUNCATE, UPDATE, DELETE ON FUTURE TABLES IN DATABASE demo_db TO ROLE sqlmesh (base.py:2062)
2024-11-21 21:53:24,487 - ThreadPoolExecutor-13_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:24,490 - ThreadPoolExecutor-13_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: GRANT REFERENCES, SELECT ON FUTURE VIEWS IN DATABASE demo_db TO ROLE sqlmesh (base.py:2062)
2024-11-21 21:53:24,679 - ThreadPoolExecutor-13_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:24,681 - ThreadPoolExecutor-13_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: GRANT ROLE sqlmesh TO USER neeraj (base.py:2062)
2024-11-21 21:53:24,883 - ThreadPoolExecutor-13_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:24,906 - ThreadPoolExecutor-13_0 - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'NB_DEMOS.sqlmesh__SQLMESH_EXAMPLE.SQLMESH_EXAMPLE__GRANT_MODEL__171822437' (evaluator.py:1196)
2024-11-21 21:53:24,908 - ThreadPoolExecutor-13_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "NB_DEMOS"."sqlmesh__SQLMESH_EXAMPLE"."SQLMESH_EXAMPLE__GRANT_MODEL__171822437" ("ID" INT, "ITEM_ID" INT, "EVENT_DATE" DATE) (base.py:2062)
2024-11-21 21:53:25,181 - ThreadPoolExecutor-13_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:25,182 - ThreadPoolExecutor-13_0 - sqlmesh.core.snapshot.evaluator - INFO - Dry running model 'sqlmesh_example.grant_model' (evaluator.py:1218)
2024-11-21 21:53:25,188 - ThreadPoolExecutor-13_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT "SEED_MODEL"."ID" AS "ID", "SEED_MODEL"."ITEM_ID" AS "ITEM_ID", "SEED_MODEL"."EVENT_DATE" AS "EVENT_DATE" FROM NB_DEMOS."sqlmesh__SQLMESH_EXAMPLE"."SQLMESH_EXAMPLE__SEED_MODEL__371811167" AS "SEED_MODEL" WHERE ("SEED_MODEL"."EVENT_DATE" <= CAST('1970-01-01' AS DATE) AND "SEED_MODEL"."EVENT_DATE" >= CAST('1970-01-01' AS DATE)) AND FALSE LIMIT 0 (base.py:2062)
2024-11-21 21:53:25,394 - ThreadPoolExecutor-13_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0 (cursor.py:1166)
2024-11-21 21:53:25,584 - ThreadPoolExecutor-13_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:25,590 - MainThread - snowflake.connector.connection - INFO - closed (connection.py:789)
2024-11-21 21:53:25,718 - MainThread - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session (connection.py:795)
2024-11-21 21:53:26,280 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 0 (cursor.py:1166)
2024-11-21 21:53:26,680 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:27,017 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:27,278 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:32,487 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:33,605 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 9 (cursor.py:1166)
2024-11-21 21:53:33,787 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:34,019 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:35,212 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:36,486 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:36,680 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:36,982 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 0 (cursor.py:1166)
2024-11-21 21:53:37,123 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:37,385 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:37,579 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:37,584 - ThreadPoolExecutor-24_0 - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"NB_DEMOS"."SQLMESH_EXAMPLE"."GRANT_MODEL": 3489965508> (evaluator.py:508)
2024-11-21 21:53:37,585 - ThreadPoolExecutor-24_0 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.2, Platform: Windows-10-10.0.19045-SP0 (connection.py:414)
2024-11-21 21:53:37,586 - ThreadPoolExecutor-24_0 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain (connection.py:1197)
2024-11-21 21:53:37,586 - ThreadPoolExecutor-24_0 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity. (connection.py:1278)
2024-11-21 21:53:39,262 - ThreadPoolExecutor-24_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: USE ROLE "ACCOUNTADMIN" (base.py:2062)
2024-11-21 21:53:39,417 - ThreadPoolExecutor-24_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:39,418 - ThreadPoolExecutor-24_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE ROLE IF NOT EXISTS sqlmesh (base.py:2062)
2024-11-21 21:53:39,591 - ThreadPoolExecutor-24_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:39,592 - ThreadPoolExecutor-24_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE DATABASE IF NOT EXISTS "DEMO_DB" (base.py:2062)
2024-11-21 21:53:39,781 - ThreadPoolExecutor-24_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:39,784 - ThreadPoolExecutor-24_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: GRANT USAGE ON WAREHOUSE "COMPUTE_WH" TO ROLE "SQLMESH" (base.py:2062)
2024-11-21 21:53:39,983 - ThreadPoolExecutor-24_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:39,984 - ThreadPoolExecutor-24_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: GRANT USAGE ON DATABASE "DEMO_DB" TO ROLE "SQLMESH" (base.py:2062)
2024-11-21 21:53:40,117 - ThreadPoolExecutor-24_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:40,119 - ThreadPoolExecutor-24_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: GRANT CREATE SCHEMA ON DATABASE "DEMO_DB" TO ROLE "SQLMESH" (base.py:2062)
2024-11-21 21:53:40,384 - ThreadPoolExecutor-24_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:40,386 - ThreadPoolExecutor-24_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: GRANT USAGE ON FUTURE SCHEMAS IN DATABASE demo_db TO ROLE sqlmesh (base.py:2062)
2024-11-21 21:53:40,590 - ThreadPoolExecutor-24_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:40,592 - ThreadPoolExecutor-24_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: GRANT CREATE TABLE ON FUTURE SCHEMAS IN DATABASE demo_db TO ROLE sqlmesh (base.py:2062)
2024-11-21 21:53:40,789 - ThreadPoolExecutor-24_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:40,791 - ThreadPoolExecutor-24_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: GRANT CREATE VIEW ON FUTURE SCHEMAS IN DATABASE demo_db TO ROLE sqlmesh (base.py:2062)
2024-11-21 21:53:40,981 - ThreadPoolExecutor-24_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:40,983 - ThreadPoolExecutor-24_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: GRANT SELECT, INSERT, TRUNCATE, UPDATE, DELETE ON FUTURE TABLES IN DATABASE demo_db TO ROLE sqlmesh (base.py:2062)
2024-11-21 21:53:41,181 - ThreadPoolExecutor-24_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:41,182 - ThreadPoolExecutor-24_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: GRANT REFERENCES, SELECT ON FUTURE VIEWS IN DATABASE demo_db TO ROLE sqlmesh (base.py:2062)
2024-11-21 21:53:41,381 - ThreadPoolExecutor-24_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:41,383 - ThreadPoolExecutor-24_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: GRANT ROLE sqlmesh TO USER neeraj (base.py:2062)
2024-11-21 21:53:41,586 - ThreadPoolExecutor-24_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:41,623 - ThreadPoolExecutor-24_0 - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2020-01-01 00:00:00+00:00, 2024-11-21 00:00:00+00:00) into NB_DEMOS.sqlmesh__SQLMESH_EXAMPLE.SQLMESH_EXAMPLE__GRANT_MODEL__171822437' (evaluator.py:538)
2024-11-21 21:53:41,628 - ThreadPoolExecutor-24_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "NB_DEMOS"."sqlmesh__SQLMESH_EXAMPLE"."SQLMESH_EXAMPLE__GRANT_MODEL__171822437" WHERE "EVENT_DATE" BETWEEN CAST('2020-01-01' AS DATE) AND CAST('2024-11-20' AS DATE) (base.py:2062)
2024-11-21 21:53:41,999 - ThreadPoolExecutor-24_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "NB_DEMOS"."sqlmesh__SQLMESH_EXAMPLE"."SQLMESH_EXAMPLE__GRANT_MODEL__171822437" ("ID", "ITEM_ID", "EVENT_DATE") SELECT "ID", "ITEM_ID", "EVENT_DATE" FROM (SELECT "SEED_MODEL"."ID" AS "ID", "SEED_MODEL"."ITEM_ID" AS "ITEM_ID", "SEED_MODEL"."EVENT_DATE" AS "EVENT_DATE" FROM "NB_DEMOS"."sqlmesh__SQLMESH_EXAMPLE"."SQLMESH_EXAMPLE__SEED_MODEL__371811167" AS "SEED_MODEL" WHERE "SEED_MODEL"."EVENT_DATE" <= CAST('2024-11-20' AS DATE) AND "SEED_MODEL"."EVENT_DATE" >= CAST('2020-01-01' AS DATE)) AS "_subquery" WHERE "EVENT_DATE" BETWEEN CAST('2020-01-01' AS DATE) AND CAST('2024-11-20' AS DATE) (base.py:2062)
2024-11-21 21:53:42,725 - ThreadPoolExecutor-24_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:42,729 - ThreadPoolExecutor-24_0 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.2, Platform: Windows-10-10.0.19045-SP0 (connection.py:414)
2024-11-21 21:53:42,729 - ThreadPoolExecutor-24_0 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain (connection.py:1197)
2024-11-21 21:53:42,729 - ThreadPoolExecutor-24_0 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity. (connection.py:1278)
2024-11-21 21:53:44,186 - ThreadPoolExecutor-24_0 - sqlmesh.core.state_sync.engine_adapter - INFO - Adding interval (1577836800000, 1732147200000) for snapshot SnapshotId<"NB_DEMOS"."SQLMESH_EXAMPLE"."GRANT_MODEL": 3489965508> (engine_adapter.py:933)
2024-11-21 21:53:44,385 - ThreadPoolExecutor-24_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:44,678 - ThreadPoolExecutor-24_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:44,879 - ThreadPoolExecutor-24_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:47,459 - ThreadPoolExecutor-24_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:47,879 - ThreadPoolExecutor-24_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10 (cursor.py:1166)
2024-11-21 21:53:48,056 - ThreadPoolExecutor-24_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:48,284 - ThreadPoolExecutor-24_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:48,973 - ThreadPoolExecutor-24_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:50,252 - ThreadPoolExecutor-24_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:50,410 - ThreadPoolExecutor-24_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:50,440 - MainThread - snowflake.connector.connection - INFO - closed (connection.py:789)
2024-11-21 21:53:50,596 - MainThread - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session (connection.py:795)
2024-11-21 21:53:50,784 - MainThread - snowflake.connector.connection - INFO - closed (connection.py:789)
2024-11-21 21:53:50,909 - MainThread - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session (connection.py:795)
2024-11-21 21:53:51,044 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Promoting environment 'prod' (engine_adapter.py:266)
2024-11-21 21:53:51,274 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 10 (cursor.py:1166)
2024-11-21 21:53:51,481 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:52,379 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:52,813 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:53,286 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:55,681 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:56,180 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 14 (cursor.py:1166)
2024-11-21 21:53:56,380 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:57,624 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:53:58,582 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:54:00,180 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:54:00,379 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:54:00,610 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:54:00,638 - MainThread - sqlmesh.core.dialect - WARNING - 'CREATE ROLE IF NOT EXISTS sqlmesh' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:54:00,643 - MainThread - sqlmesh.core.dialect - WARNING - 'GRANT USAGE ON FUTURE SCHEMAS IN DATABASE demo_db TO ROLE sqlmesh' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:54:00,646 - MainThread - sqlmesh.core.dialect - WARNING - 'GRANT CREATE TABLE ON FUTURE SCHEMAS IN DATABASE demo_db TO ROLE sqlmesh' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:54:00,649 - MainThread - sqlmesh.core.dialect - WARNING - 'GRANT CREATE VIEW ON FUTURE SCHEMAS IN DATABASE demo_db TO ROLE sqlmesh' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:54:00,650 - MainThread - sqlmesh.core.dialect - WARNING - 'GRANT SELECT, INSERT, TRUNCATE, UPDATE, DELETE ON FUTURE TABLES IN DATABASE demo_db TO ROLE sqlmesh' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:54:00,652 - MainThread - sqlmesh.core.dialect - WARNING - 'GRANT REFERENCES, SELECT ON FUTURE VIEWS IN DATABASE demo_db TO ROLE sqlmesh' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:54:00,653 - MainThread - sqlmesh.core.dialect - WARNING - 'GRANT ROLE sqlmesh TO USER neeraj' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:54:00,658 - MainThread - sqlmesh.core.dialect - WARNING - 'CREATE ROLE IF NOT EXISTS sqlmesh' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:54:00,660 - MainThread - sqlmesh.core.dialect - WARNING - 'GRANT USAGE ON FUTURE SCHEMAS IN DATABASE demo_db TO ROLE sqlmesh' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:54:00,662 - MainThread - sqlmesh.core.dialect - WARNING - 'GRANT CREATE TABLE ON FUTURE SCHEMAS IN DATABASE demo_db TO ROLE sqlmesh' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:54:00,663 - MainThread - sqlmesh.core.dialect - WARNING - 'GRANT CREATE VIEW ON FUTURE SCHEMAS IN DATABASE demo_db TO ROLE sqlmesh' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:54:00,665 - MainThread - sqlmesh.core.dialect - WARNING - 'GRANT SELECT, INSERT, TRUNCATE, UPDATE, DELETE ON FUTURE TABLES IN DATABASE demo_db TO ROLE sqlmesh' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:54:00,666 - MainThread - sqlmesh.core.dialect - WARNING - 'GRANT REFERENCES, SELECT ON FUTURE VIEWS IN DATABASE demo_db TO ROLE sqlmesh' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:54:00,668 - MainThread - sqlmesh.core.dialect - WARNING - 'GRANT ROLE sqlmesh TO USER neeraj' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:54:00,671 - MainThread - sqlmesh.core.dialect - WARNING - 'CREATE ROLE IF NOT EXISTS sqlmesh' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:54:00,674 - MainThread - sqlmesh.core.dialect - WARNING - 'GRANT USAGE ON FUTURE SCHEMAS IN DATABASE demo_db TO ROLE sqlmesh' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:54:00,677 - MainThread - sqlmesh.core.dialect - WARNING - 'GRANT CREATE TABLE ON FUTURE SCHEMAS IN DATABASE demo_db TO ROLE sqlmesh' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:54:00,680 - MainThread - sqlmesh.core.dialect - WARNING - 'GRANT CREATE VIEW ON FUTURE SCHEMAS IN DATABASE demo_db TO ROLE sqlmesh' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:54:00,682 - MainThread - sqlmesh.core.dialect - WARNING - 'GRANT SELECT, INSERT, TRUNCATE, UPDATE, DELETE ON FUTURE TABLES IN DATABASE demo_db TO ROLE sqlmesh' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:54:00,684 - MainThread - sqlmesh.core.dialect - WARNING - 'GRANT REFERENCES, SELECT ON FUTURE VIEWS IN DATABASE demo_db TO ROLE sqlmesh' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:54:00,686 - MainThread - sqlmesh.core.dialect - WARNING - 'GRANT ROLE sqlmesh TO USER neeraj' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:54:00,689 - MainThread - sqlmesh.core.dialect - WARNING - 'CREATE ROLE IF NOT EXISTS sqlmesh' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:54:00,692 - MainThread - sqlmesh.core.dialect - WARNING - 'GRANT USAGE ON FUTURE SCHEMAS IN DATABASE demo_db TO ROLE sqlmesh' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:54:00,693 - MainThread - sqlmesh.core.dialect - WARNING - 'GRANT CREATE TABLE ON FUTURE SCHEMAS IN DATABASE demo_db TO ROLE sqlmesh' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:54:00,695 - MainThread - sqlmesh.core.dialect - WARNING - 'GRANT CREATE VIEW ON FUTURE SCHEMAS IN DATABASE demo_db TO ROLE sqlmesh' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:54:00,696 - MainThread - sqlmesh.core.dialect - WARNING - 'GRANT SELECT, INSERT, TRUNCATE, UPDATE, DELETE ON FUTURE TABLES IN DATABASE demo_db TO ROLE sqlmesh' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:54:00,698 - MainThread - sqlmesh.core.dialect - WARNING - 'GRANT REFERENCES, SELECT ON FUTURE VIEWS IN DATABASE demo_db TO ROLE sqlmesh' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:54:00,722 - MainThread - sqlmesh.core.dialect - WARNING - 'GRANT ROLE sqlmesh TO USER neeraj' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables (dialect.py:323)
2024-11-21 21:54:00,727 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Unpausing snapshot SnapshotId<"NB_DEMOS"."SQLMESH_EXAMPLE"."GRANT_MODEL": 3489965508> (engine_adapter.py:435)
2024-11-21 21:54:01,881 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:54:01,902 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'NB_DEMOS.SQLMESH_EXAMPLE' (evaluator.py:906)
2024-11-21 21:54:01,906 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "NB_DEMOS"."SQLMESH_EXAMPLE" (base.py:2062)
2024-11-21 21:54:02,078 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:54:02,219 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:54:02,224 - ThreadPoolExecutor-41_0 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'NB_DEMOS.SQLMESH_EXAMPLE.GRANT_MODEL' to point at table 'NB_DEMOS.sqlmesh__SQLMESH_EXAMPLE.SQLMESH_EXAMPLE__GRANT_MODEL__171822437' (evaluator.py:1162)
2024-11-21 21:54:02,227 - ThreadPoolExecutor-41_0 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.2, Platform: Windows-10-10.0.19045-SP0 (connection.py:414)
2024-11-21 21:54:02,229 - ThreadPoolExecutor-41_0 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain (connection.py:1197)
2024-11-21 21:54:02,229 - ThreadPoolExecutor-41_0 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity. (connection.py:1278)
2024-11-21 21:54:03,725 - ThreadPoolExecutor-41_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "NB_DEMOS"."SQLMESH_EXAMPLE"."GRANT_MODEL" COPY GRANTS AS SELECT * FROM "NB_DEMOS"."sqlmesh__SQLMESH_EXAMPLE"."SQLMESH_EXAMPLE__GRANT_MODEL__171822437" (base.py:2062)
2024-11-21 21:54:04,081 - ThreadPoolExecutor-41_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:54:04,281 - ThreadPoolExecutor-41_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:54:04,289 - MainThread - snowflake.connector.connection - INFO - closed (connection.py:789)
2024-11-21 21:54:04,414 - MainThread - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session (connection.py:795)
2024-11-21 21:54:04,584 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Finalizing environment 'prod' (engine_adapter.py:387)
2024-11-21 21:54:04,814 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:54:05,588 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 21:54:05,604 - MainThread - snowflake.connector.connection - INFO - closed (connection.py:789)
2024-11-21 21:54:05,777 - MainThread - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session (connection.py:795)
2024-11-21 21:54:05,904 - MainThread - snowflake.connector.connection - INFO - closed (connection.py:789)
2024-11-21 21:54:06,112 - MainThread - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session (connection.py:795)
2024-11-21 21:54:06,309 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
